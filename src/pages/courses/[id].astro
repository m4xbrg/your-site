---
import { getCollection } from 'astro:content';
import Docs from '../../layouts/DocsLayout.astro';
import { collectionNames } from '../../lib/collections';
import TagChips from '../../components/TagChips.astro';

export async function getStaticPaths() {
  const courses = await getCollection(collectionNames.courses);
  return courses.map((course) => ({ params: { id: course.data.id } }));
}

const { id } = Astro.params;
const all = await getCollection(collectionNames.courses);
const course = all.find((c) => c.data.id === id);
if (!course) throw new Error(`Course not found: ${id}`);
const { Content } = await course.render();
---
<Docs title={`${course.data.title} â€” YourSite`}>
  <h1 class="text-3xl font-bold mb-2">{course.data.title}</h1>
  {course.data.description && <p class="text-[color:var(--muted)] mb-6">{course.data.description}</p>}
  <TagChips tags={course.data.tags ?? []} class="mb-6" />
  {course.data.outline && (
    <ol class="list-decimal pl-6 space-y-1 mb-6">
      {course.data.outline.map((o) => (
        <li>
          {o.conceptSlug ? <a class="text-brand-300" href={`/concepts/${o.conceptSlug}`}>{o.label}</a> : o.label}
        </li>
      ))}
    </ol>
  )}
  <article class="prose prose-invert max-w-none">
    <Content />
  </article>
</Docs>
