---
import { getCollection } from 'astro:content'
const sortByOrder = (a,b) => (a.data.order ?? 0) - (b.data.order ?? 0)
const subjects = (await getCollection('subjects')).slice().sort(sortByOrder)
const courses  = (await getCollection('courses')).slice().sort(sortByOrder)
const concepts = (await getCollection('concepts')).slice().sort(sortByOrder)
---
<nav class="space-y-6">
  <div>
    <h2 class="text-xs uppercase tracking-wide text-gray-500 mb-2">Subjects</h2>
    <ul class="space-y-1">
      {subjects.map(s => (
        <li><a class={`sidebar-link ${Astro.url.pathname.startsWith(`/subjects/${s.slug}`)?'active':''}`} href={`/subjects/${s.slug}/`}>{s.data.title}</a></li>
      ))}
    </ul>
  </div>
  <div>
    <h2 class="text-xs uppercase tracking-wide text-gray-500 mb-2">Courses</h2>
    <ul class="space-y-1">
      {courses.map(c => (
        <li><a class={`sidebar-link ${Astro.url.pathname.startsWith(`/courses/${c.data.id}`)?'active':''}`} href={`/courses/${c.data.id}/`}>{c.data.code} â€” {c.data.title}</a></li>
      ))}
    </ul>
  </div>
  <div>
    <h2 class="text-xs uppercase tracking-wide text-gray-500 mb-2">Concepts</h2>
    <ul class="space-y-1">
      {concepts.map(x => (
        <li><a class={`sidebar-link ${Astro.url.pathname.includes(`/concepts/${x.slug}`)?'active':''}`} href={`/concepts/${x.slug}/`}>{x.data.title}</a></li>
      ))}
    </ul>
  </div>
</nav>
